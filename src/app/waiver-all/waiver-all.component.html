<div class="row g-3 justify-content-center mt-1">

  @if(true) {
  <div class="row justify-content-start">
    <div class="col-3 d-flex justify-content-end">
      <span class="input-group-text" id="basic-addon1">
        <i class="fa fa-search" aria-hidden="true"></i>
      </span>
      <input type="text" class="form-control" placeholder="Search Courses" aria-label="Username"
        aria-describedby="basic-addon1" [(ngModel)]="searchCourse" (input)="searchForCourse()">

    </div>


  </div>

  <!-- Table  -->
  <div class="col">
    <table class="table table-bordered table-responsible table-hover">
      <thead class="text-dark text-center">
        <th class="text-uppercase">Course <br> Code </th>
        <th class="text-uppercase">Course <br> Name </th>
        <th class="text-uppercase">Credits <br> (L-T-P-C) </th>
        <th class="text-uppercase">Instructor </th>
        <th class="text-uppercase">Slot </th>
        <th class="text-uppercase">Prerequisite <br> Met? </th>
      </thead>


      <tbody>

        @for (item of displayedCourses ; track $index) {

        <tr scope="col" class="text-center" [ngClass]="isCourseAlreadyCompleted(item) ? 'table-secondary': ''">
          <div class="container-fluid text-center d-flex justify-content-center">
            <td class="text-dark" placement="top"
              [ngbTooltip]=" isCourseAlreadyCompleted(item)? 'Course already completed':''" placement="right">
              {{item.code}}
              @if(isCourseAlreadyCompleted(item)){
              <i class="fa-solid fa-circle-check text-success"></i>
              }
            </td>
          </div>

          <td> {{item.name}} </td>
          <td> {{item.credits}} </td>
          <td>
            <div>
              {{item.instructor.join(",\n")}}
            </div>
          </td>
          <td> {{item.slot}} </td>
          <td>
            @if(checkPrerequisiteMet(item)){
            <i class="fa-solid fa-check text-success"></i>
            }
            @else if(!isAppliedForWaiver(item)) {
            <i class="fa-solid fa-x text-danger"></i> <br>
            
            <button class="badge bg-primary" (click)="toggleCollapseApply(item.code)"
              [attr.aria-expanded]="!isCollapsed" aria-controls="collapseExample">
              <i class="fa-regular fa-pen-to-square"></i>

            </button>
            <div #collapse="ngbCollapse" [ngbCollapse]="!collapsedStatesApply[item.code]">
              <div class="card">
                <div class="card-body">
                  <div class="mb-3">
                    <input type="text" class="form-control" placeholder="State Reason" aria-label="Username"
                      [(ngModel)]="reasonForWaiver" aria-describedby="basic-addon1">
                  </div>
                  <button class="btn btn-primary" (click)="applyForWaiver(item)">Apply</button>
                </div>
              </div>
            </div>

            }
            @else {
              <span class="badge bg-success">Applied</span>
            }
          </td>

        </tr>
        }

      </tbody>

    </table>
    

  </div>

  <div class="d-flex justify-content-between p-2">
    <ngb-pagination
      [collectionSize]="selectedCourses.length"
      [(page)]="page"
      [pageSize]="pageSize"
      (pageChange)="refreshCourses()"
    >
    </ngb-pagination>
  
    <select class="form-select" style="width: auto" [(ngModel)]="pageSize" (ngModelChange)="refreshCourses()">
      <option [ngValue]="2">2 items per page</option>
      <option [ngValue]="4">4 items per page</option>
      <option [ngValue]="6">6 items per page</option>
    </select>
  </div>
  
  }
  
  <!-- <app-testing-table></app-testing-table> -->
</div>