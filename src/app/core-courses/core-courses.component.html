<div class="card bg-dark p-0 text-white rounded-0">
  <div class="card-body p-1">
    <div class="row">
      <div class="col-md-4 col-sm-12">
        <span class="mx-1">Program: B.Tech</span>
      </div>
      <div class="col-md-4 col-sm-12">
        <span class="mx-1">Branch: CSE</span>
      </div>
      <div class="col-md-4 col-sm-12">
        <span class="mx-1">Semester: 4</span>
      </div>
    </div>
  </div>
</div>

<div class="d-flex justify-content-end p-0 pt-2">
  <div>
    <input
      type="text"
      class="form-control mb-3 rounded-0"
      style="width: 400px"
      placeholder="Search courses..."
      [(ngModel)]="searchQuery"
    />
  </div>

  Â 
</div>

<div class="table-responsive">
  <div class="d-flex justify-content-end pt-3 border border-light">
    <table class="table">
      <thead class="">
        <tr class="">
          <th>Course Code</th>
          <th>Course Name</th>
          <th>Credits(L-T-P-C)</th>
          <th>Intructor</th>
          <th>Slot</th>
          <th>Prerequisite met?</th>
          <th>Prerequisite Waiver</th>
        </tr>
      </thead>
      <tbody>
        @for (course of coreCourses | filter: searchQuery; track course.code) {
        <tr>
          <td>
            @if(isComplete(course.code)){
            <button
              type="button"
              class="btn btn-outline-dark me-2"
              ngbTooltip="Course already completed"
              tooltipClass="tooltip-styles"
              [openDelay]="300"
              [closeDelay]="400"
              (click)="toggleCollapse(course.code)"
              [attr.aria-expanded]="!collapsedStates[course.code]"
              aria-controls="collapseExample"
            >
              {{ course.code }}
            </button>

            <div
              #collapse="ngbCollapse"
              [ngbCollapse]="!collapsedStates[course.code]"
              class="position position-absolute"
            >
              <div class="card">
                <div class="card-body">
                  <app-course-detail
                    [courseDetail]="course"
                  ></app-course-detail>
                </div>
              </div>
            </div>

            }@else {
            <button
              type="button"
              class="btn btn-outline-primary me-2"
              (click)="toggleCollapse(course.code)"
              [attr.aria-expanded]="!collapsedStates[course.code]"
              aria-controls="collapseExample"
            >
              {{ course.code }}
            </button>
            <div
              #collapse="ngbCollapse"
              [ngbCollapse]="!collapsedStates[course.code]"
              class="position position-absolute"
            >
              <div class="card">
                <div class="card">
                  <div class="card-body">
                    <app-course-detail
                      [courseDetail]="course"
                    ></app-course-detail>
                  </div>
                </div>
              </div>
            </div>

            }
          </td>
          <td>
            <span class="text-truncate">{{ course.name }}</span>
          </td>
          <td>
            <span class="fw-bold">{{ course.credits }}</span>
          </td>
          <td>{{ course.instructor }}</td>
          <td>{{ course.slot }}</td>
          <td>
            @if(true){
              <span class="badge px-3 text-white bg-success"
                ><i class="fa-solid fa-check"></i
              ></span>
              }@else {
              <span class="badge bg-warning px-3 text-white"
                ><i class="fa-solid fa-xmark"></i
              ></span>
              }
          </td>
          <td style="width: 17vw">
            @if( true ){
              <button
                type="button"
                class="btn btn-primary p1-2 text-white px-4"
                (click)="toggleOrConfirmApply(course.code)"
                [attr.aria-expanded]="!collapsedStatesApply[course.code]"
                aria-controls="collapseExample" 
              >
                Apply</button
              >}
              <div
            #collapse="ngbCollapse"
            [ngbCollapse]="!collapsedStatesApply[course.code]"
          >
            <input
              [(ngModel)]="reasonInput"
              name="reason-{{ course.code }}"
              type="text"
              class="form-control mt-1"
              placeholder="Reason for waiver"
            />
          </div>

          <!-- Confirmation Modal -->
          @if(isCnfModalVisible){
            <ng-template #content let-modal>
              <div class="modal-body">
                <h2>Confirm Application</h2>
                <p>Are you sure you want to apply for this course?</p>
              </div>
              <div class="modal-footer">
                <button (click)="confirmApplication()">Yes</button>
                <button (click)="isCnfModalVisible = false">No</button>
              </div>
            </ng-template>
            }
  


    
          </td>
        </tr>

        }
      </tbody>
    </table>
  </div>
</div>
